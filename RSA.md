# Rivest–Shamir–Adleman Cryptosystem

## Creating some RSA key

### Importing the necessary modules


```python
import BigNumber
import random
import numpy as np
import math
from math import ceil, floor
import sys
```

### Ferman Test to check primality


```python
def checkPrime(a):
    if a==2:
        return True
    i=0
    while i<5:
        p=np.random.randint(2,20)
        if pow(p,a-1,a)!=1:
            return False
        else:
            return True
        i+=1
```

### Generating a large Prime Number


```python
def LargePrime(k):  
    
    b=100*(math.log(k,2)+1) #number of attempts max
    while b>0:
        
        n = random.randrange(2**(k-1),2**(k))
        b-=1
        if checkPrime(n) == True:
            
            
            return n
    return "Failure in computing"
```

### Creating our prime numbers: $p$ and $q$


```python
p=LargePrime(500)
p
```




    3249776501020779267775182375414562658677693110838933477280018350448634979882603199190168479003004174325707133928796341887838335089375586921082599209917




```python
q=LargePrime(500)
q
```




    2575372804269009858772912799458871750192981992497673772790767963801417538532951205483672090988429949205095421700609214839713984632377591808823554285043



### Generating $n$ and $m$


```python
n = p*q
print(n)
```

    8369386020681415082698368814675956175223556456879699094798913989860286839559667171941780160388074831811877637013564462305403126687937965719672579288737328370411579449528266709776060227036950615507128989977929708861159269492063240290177423190001976769301823091003947404749982940646613215807311610371431
    


```python
m = (p-1)*(q-1)
print(m)
```

    8369386020681415082698368814675956175223556456879699094798913989860286839559667171941780160388074831811877637013564462305403126687937965719672579288731503221106289660401718614601186792628079940403792382727858922546909216973647685885503582620010542645771020535374541848022430620924860037077405456876472
    

### Calculating $e$ and $d$

#### For Euclidean GCD


```python
def euc_gcd(e, m):
    while m != 0:
        e, m = m, e % m
    return e
```

##### We can pick $e$ randomly in the range $0 < e < m$, then calculate the gcd of e and m using Euclid’s algorithm. 
##### If the gcd is not 1, we pick again.


```python
e = random.randrange(1, 1024,2)
gcd = euc_gcd(e, m)
while gcd != 1:
    e = random.randrange(1, 1024,2)
    gcd = euc_gcd(e, m)
```

##### We know if gcd(e, m) = 1, then $ed ≡ 1$ mod  $m$ has a unique solution:
$$gcd(e,m) = ex+my = 1$$
##### From this we can calculate $d$
##### To calculate $x$ and $y$, we extend the algorithm
##### Let $e = qm + r$ such that $0 <= r < m$. Then
$$g = um + vr$$
$$= um + v(e − qm)$$
$$= ve + (u − qv)m$$
##### Thus we can take $x = v$ and $y = u − qv$


```python
def extended_euclid(m,n):
    if n == 0:
        return (m,1,0)
    else:
        q = m // n
        r = m % n
        (g,u,v) = extended_euclid(n,r)
    return (g,v,u-q*v)
```


```python
def inv(e,m):
    (g,x,y) = extended_euclid(e,m)
    if (g != 1):
        return (0) 
    else:
        return(x % m)
```


```python
g,u,v = extended_euclid(m,n)
d = inv(e,m)
(e*d)%m       #verification
```




    1



## Declaring our Private and Public Keys


```python
public_key = (e,n)
private_key = (d,n)
```

## Implementing our RSA key

### Defining our encrypting function (Plaintext to Ciper Text)
$P(M) = M^e$ mod $n$


```python
def encrypt(plain):
    e,n=public_key
    x=[]
    M=0
    for i in plain:
        M = ord(i)
        c=pow(M,e,n)
        x.append(c)
    return x
```

### Defining our decrypting function (Ciper Text to Plaintext)
$S(C) = C^d$ mod $n$


```python
def decrypt(cipher):
    d,n=private_key
    x=''
    M=0
    for i in cipher:
        m=pow(i,d,n)
        c=chr(m)
        x+=c
    return x  
```


```python
plaintext = 'Optimus Prime robbing a 7/11'
cipher = encrypt(plaintext)
print('The encrypted message is: \n', cipher)
```

    The encrypted message is: 
     [4509710523305229518712904693109989718156762452139110443580183893705288582971389117974629146135961382849969341644218504960107022949418372084259278835050983224152616276560354077029768655336255894837585107612908041308286824601878486173906463374355412813616253322506609412116520539179937003767220819388243, 3072135538642045114971142742404109334541231685711824359312932175089788536508759908801314659117663160637978185135170550087075334690134328961794604875649537502094147467091481278276319176680293622580714503006802785978583364669898723926207191834447512222105580701068016573292489301007349163476531537832035, 4729078474538289437645598928931493480610093238551122259046600592535035693559367779288588769653292069487230134297285413253461578047108258342503128759964316314856138862692372803428148867707515495133112913955752103560656147679364734589428344077232133469688028539028270442745127351295567531302049655148789, 4198457007046510558001498103909944221581870160033023075495273160446172675125280104215256921321845582120840696152086093140246160310455926802518621183397434681137472216396975718338132567698548637652335529617596954978224779001542414742989648677232889105212759114561790154433130425436085255176281994397822, 3897842754001737912330264564486098491035049326350275022142847914327365803229536842525019909923043203154109058650372657369136437220229646094098009232172042113402598954915318543961891643180428504869622055013477356455727183618062135605261608078186270243010642729646411494559924335018933611445449032514373, 6990044644728617963887677236253737076873186742332383794700370855408358790196131706191895551570086352398085569531395055705287404198212182717049205977982801117629218254925342904468225147159934896278045365941752244796232232539042950890544349860860405635568149716655309798426329983620037288633123146863864, 4580205742867039944439812121500532028946146457441909664719290362621092864708454318129491428092950088784137749679808574693918693525605143476273607929691719565706822184101958577228056777233086595443629836299847674341315674414056301400982626353000721170809819128722442881763656841764170930747885612153573, 4082234569794334183129055091430304781222276727460385415651343587258814327123489513696151400979489597442686399283985511496654304572244198892650163173571657060114436058355217911421652679807425672432078024037503997498394085078238462428199366841112648618166352785968970948882279055693661728124800142435188, 2163194656517019088048340661410816896836150269682423292124632966315246206100503016269840850836672471454523072083099444573557915777853346359966758767751039779071892005631046574797419246771038977130682893016464773794368712394874464284903370235599683929763645667221354805166498515430317119026738533243324, 1716875121161209629607725345522774228892764201221699249630653381424812188804681439287166999309502439333481039844594337385197793331950449725133371642479723451357863036794872778178272879827199629793249783127409482484239737688243140590327698662333034212039851898173610899664427531328144124587059770442201, 4198457007046510558001498103909944221581870160033023075495273160446172675125280104215256921321845582120840696152086093140246160310455926802518621183397434681137472216396975718338132567698548637652335529617596954978224779001542414742989648677232889105212759114561790154433130425436085255176281994397822, 3897842754001737912330264564486098491035049326350275022142847914327365803229536842525019909923043203154109058650372657369136437220229646094098009232172042113402598954915318543961891643180428504869622055013477356455727183618062135605261608078186270243010642729646411494559924335018933611445449032514373, 821431218889561932288603106146923476628227392123324191113654918259072308645079403861265444651471150893664659689072175332542339939410944018474335817618523658476420206373394851725697649479320497409426911521598731596889584430311272537274291243480631302499508748232884510028831751607632029634484548348539, 4082234569794334183129055091430304781222276727460385415651343587258814327123489513696151400979489597442686399283985511496654304572244198892650163173571657060114436058355217911421652679807425672432078024037503997498394085078238462428199366841112648618166352785968970948882279055693661728124800142435188, 1716875121161209629607725345522774228892764201221699249630653381424812188804681439287166999309502439333481039844594337385197793331950449725133371642479723451357863036794872778178272879827199629793249783127409482484239737688243140590327698662333034212039851898173610899664427531328144124587059770442201, 2159027733639694230634432432600177084039625912070119444726629639889933101666933504345018835443496469028663679143209961833010795057181005112764886595195762990889133174696296387863366255485290025081606079843222138352804804117149383834032784709035256969132314778262146438210132413182622167232194357794457, 909747181726980780371260090195932691809428113019286196688047082782013909233123188438747724554600168615627378828271424812127946281647370454051784619228534273697815590088572994885904340801372018211219003016327314756657520610787484082466709341252475753779335648416244909353576677859613408789334758722091, 909747181726980780371260090195932691809428113019286196688047082782013909233123188438747724554600168615627378828271424812127946281647370454051784619228534273697815590088572994885904340801372018211219003016327314756657520610787484082466709341252475753779335648416244909353576677859613408789334758722091, 4198457007046510558001498103909944221581870160033023075495273160446172675125280104215256921321845582120840696152086093140246160310455926802518621183397434681137472216396975718338132567698548637652335529617596954978224779001542414742989648677232889105212759114561790154433130425436085255176281994397822, 2594705910772229216126788089340421107528645462048643839872271120643293783656612999728778279917795151468381431189493048099873563424876815473047205011767775418558807579726731190356863801770775169945822202189678827408868179371218217196436774314772001952565334059724060931058905031755176625097901214903578, 8208057857583039614398772216925724512024395790486230319668762344908459420067976114682691627018415960837968530664651553097049702799268469121382012687215962513432795503792660250232829751422341149789109000549682855375227661897511516065514854429173675553219323336544094057393569774232384066170123440760666, 4082234569794334183129055091430304781222276727460385415651343587258814327123489513696151400979489597442686399283985511496654304572244198892650163173571657060114436058355217911421652679807425672432078024037503997498394085078238462428199366841112648618166352785968970948882279055693661728124800142435188, 6622213496387692658182615274151150031639262236560753141600218805934688347666605359748661392961420058602283631000981181410170959808845817343253196732789434362670600428764477466669289517402788524706783877186172153641074117077409964539025907986008230685282323054352855865081124327016337119176630418227903, 4082234569794334183129055091430304781222276727460385415651343587258814327123489513696151400979489597442686399283985511496654304572244198892650163173571657060114436058355217911421652679807425672432078024037503997498394085078238462428199366841112648618166352785968970948882279055693661728124800142435188, 8129645545678985449720655735052235468506225605060166597857625294387973009679937364708828663622036839079654470994259637408955142771683253982955600899446165487469229793616679136975320763463127434397992240011855128587622922577705404869694860503719017394040525070491486576191744407850242365532654880129488, 5554053188202916513890923751943442891714628064964694296165497604778913480526763866197939328575151298595122167377467257457904619015761938245487984605666907719147891203004500633383830010510140195476573622609701569707340111811783610833756481492612507584074036158056368659912118558421559988922683222603252, 1374108001695832592130127177801841164232907494793809712995488320194837665550629181325524753442889240325891060148640929522286185468235756714395993766136569986389830056749697679853190502970260956280828313014388996734835395235935634422915769441030430901652203026381054134521045272771854602731896806939377, 1374108001695832592130127177801841164232907494793809712995488320194837665550629181325524753442889240325891060148640929522286185468235756714395993766136569986389830056749697679853190502970260956280828313014388996734835395235935634422915769441030430901652203026381054134521045272771854602731896806939377]
    


```python
x = decrypt(cipher)
print('The decrypted message is: \n\n', x)
```

    The decrypted message is: 
    
     Optimus Prime robbing a 7/11
    
